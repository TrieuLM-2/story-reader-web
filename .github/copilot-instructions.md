# Copilot Instructions for story-reader-web

## Project Overview
A Vietnamese BL/M-rated story reader built with **Jekyll on GitHub Pages**. Static site with story collection management, responsive card-based UI, and SEO optimization. Deployed to `https://trieulm-2.github.io/story-reader-web/`.

## Architecture & Key Components

### Content Structure
- **Stories as Collections**: Stories are Jekyll collections in `_stories/` - each `.md` file becomes a page at `/story-name.html`
- **Front Matter Metadata**: Every story requires YAML front matter with:
  ```yaml
  layout: story
  title, author, cover, genres, status, tags, rating, rating_count, views, date
  ```
- **Layouts**:
  - `_layouts/default.html` - Base template with header, search overlay, breadcrumb, main content wrapper
  - `_layouts/story.html` - Extends default, adds book detail view with tabs (Book Details, Table of Contents)
  - Stories auto-inherit `story.html` layout via `_config.yml` defaults

### Homepage Data Flow
- `index.md` uses Liquid template `{% for story in site.stories limit:6 %}` to display latest 6 stories
- Cards generated from story metadata; fallback to placeholder images via `onerror` attribute
- Section structure: Welcome → Trending (story cards) → Upcoming → Footer

### CSS Architecture
- **Variables**: `assets/css/variables.css` defines design tokens (colors, spacing, typography, shadows)
- **Utilities**: `assets/css/utilities.css` provides helper classes
- **Main**: `assets/css/style.css` contains component styles (cards, layout, forms)
- **Color Scheme**: Primary teal (#16a085), secondary purple (#667eea)

## Build & Deploy

### Local Development
```bash
bundle install                      # Install Ruby gems (Jekyll, plugins)
bundle exec jekyll serve           # Serve at http://localhost:4000/story-reader-web/
```

**Note**: `baseurl: "/story-reader-web"` must prefix all relative URLs (use Jekyll's `relative_url` filter).

### GitHub Pages Deployment
- Branch: `main`, folder: root `/`
- Plugins auto-build: jekyll-feed, jekyll-seo-tag, jekyll-sitemap
- Generate sitemap.xml and feed.xml automatically

### Excluded Files
`_config.yml` excludes `*.html`, `README.md` from processing to prevent duplication.

## JavaScript Patterns

### Module-based Initialization
Scripts in `script.js` attach listeners at load time:

1. **Search**: Modal overlay with ESC close and click-outside dismiss
2. **Tab Navigation**: `data-tab` attributes link buttons to content divs
3. **Smooth Scroll**: Anchor links with `scrollIntoView({ behavior: 'smooth' })`
4. **Scroll Animation**: Intersection Observer watches `.book-card` elements for fade-in effect

**Convention**: All interactive elements use CSS classes prefixed with the feature name (e.g., `.tab-btn`, `.book-card`).

## Adding New Features

### Add a Story
1. Create `_stories/my-story.md` with required YAML front matter
2. Content below `---` becomes description/body
3. Accessible immediately at `/my-story.html` after build

### Modify Homepage
Edit `index.md` - changes Liquid template or HTML. Rebuild triggers Jekyll to regenerate.

### Extend Story Details Tab
Story layout expects `page.chapters` in YAML to show "Table of Contents" tab (currently unused but supported).

### Style Updates
- **Color changes**: Edit `_assets/css/variables.css` (single source of truth)
- **New components**: Add to `style.css` and reference in templates
- **Responsive**: Use CSS Grid/Flexbox; variables define breakpoints

## SEO & Metadata

- `_layouts/default.html` includes:
  - `{% seo %}` tag (jekyll-seo-tag plugin handles meta tags)
  - Structured data (JSON-LD schema for Book type on story pages)
- Story pages auto-generate og:image, description from front matter
- Sitemap auto-generated by jekyll-sitemap plugin

## Conventions & Patterns

### Relative URLs
Always use Jekyll's `relative_url` filter: `{{ '/path' | relative_url }}`
Ensures correct paths in both local dev and GitHub Pages production.

### Liquid Templating
- Filters: `date`, `capitalize`, `url_encode`, `truncatewords`, `strip_html`
- Loops: `{% for story in site.stories %}` (ordered by date descending by default)
- Conditionals: `{% if page.property %}` (treat undefined as falsy)

### Accessibility
- Skip link in default layout
- Breadcrumb with `aria-label="Breadcrumb"`
- Main content in `<main id="main-content" role="main">`
- Semantic HTML (article, nav, section)

## Dependencies
- **Gemfile**: Ruby 2.7+, Jekyll 4.3, Bundler
- **External**: Font Awesome 6.0 (CDN), Placeholder images (placehold.co service)

## Common Edits Workflow
1. Edit markdown files (`_stories/*.md`, `index.md`)
2. Run `bundle exec jekyll serve` locally
3. Visit http://localhost:4000/story-reader-web/ to verify
4. Git push → GitHub Pages auto-deploys within 1-2 minutes
